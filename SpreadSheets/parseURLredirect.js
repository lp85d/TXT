/** @OnlyCurrentDoc */
const _cfg = {p: {oc: 10, sr: 1, slp: 1000, mr: 10}, s: {m: ['\u0047\u0065\u0074','\u0070\u006f\u0073\u0074','\u0067\u0065\u0074\u0052\u0061\u006e\u0067\u0065','\u0067\u0065\u0074\u0052\u0069\u0063\u0068\u0054\u0065\u0078\u0074\u0056\u0061\u006c\u0075\u0065','\u0067\u0065\u0074\u004c\u0069\u006e\u006b\u0055\u0072\u006c','\u0067\u0065\u0074\u0048\u0065\u0061\u0064\u0065\u0072\u0073','\u0069\u0073\u0042\u006c\u0061\u006e\u006b','\u0073\u0065\u0074\u0056\u0061\u006c\u0075\u0065','\u0072\u0065\u0070\u006c\u0061\u0063\u0065','\u0074\u0072\u0069\u006d','\u0074\u006f\u004c\u006f\u0077\u0065\u0072\u0043\u0061\u0073\u0065','\u0069\u006e\u0064\u0065\u0078\u004f\u0066','\u0073\u0070\u006c\u0069\u0074','\u006c\u0061\u0073\u0074\u0049\u006e\u0064\u0065\u0078\u004f\u0066','\u0073\u0075\u0062\u0073\u0074\u0072\u0069\u006e\u0067'], t: {mn: ['\u2728',' ','\u041f\u0430\u0440\u0441\u0435\u0440',' ','\u0441\u0441\u044b\u043b\u043e\u043a',' ','(V4)'].join(''), i1: ['\u27a4',' ','\u041e\u0431\u0440\u0430\u0431\u043e\u0442\u0430\u0442\u044c',' ','\u0422\u0415\u041a\u0423\u0429\u0423\u042e',' ','\u0441\u0442\u0440\u043e\u043a\u0443'].join(''), i2: ['\u27a4','\u27a4',' ','\u041e\u0431\u0440\u0430\u0431\u043e\u0442\u0430\u0442\u044c',' ','\u0412\u0421\u0415',' ','\u043f\u0440\u043e\u043f\u0443\u0449\u0435\u043d\u043d\u044b\u0435'].join(''), a1t: ['\u0413\u043e\u0442\u043e\u0432\u043e'].join(''), a1m: ['\u0420\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442',' ','\u0434\u043b\u044f',' ','\u0441\u0442\u0440\u043e\u043a\u0438',' ','#'].join(''), a2t: ['\u041d\u0430\u0447\u0430\u0442\u044c',' ','\u043c\u0430\u0441\u0441\u043e\u0432\u0443\u044e',' ','\u043e\u0431\u0440\u0430\u0431\u043e\u0442\u043a\u0443','?'].join(''), a2m1: ['\u0411\u0443\u0434\u0443\u0442',' ','\u043f\u0440\u043e\u0432\u0435\u0440\u0435\u043d\u044b',' ','\u0432\u0441\u0435',' ','\u0441\u0442\u0440\u043e\u043a\u0438',' ','\u0441',' '].join(''), a2m2: [' ','\u043f\u043e',' '].join(''), a2m3: ['.','\n','\u041e\u0431\u0440\u0430\u0431\u043e\u0442\u0430\u044e\u0442\u0441\u044f',' ','\u0442\u043e\u043b\u044c\u043a\u043e',' ','\u0441\u0442\u0440\u043e\u043a\u0438',' ','\u0441',' ','\u043f\u0443\u0441\u0442\u043e\u0439',' ','\u043a\u043e\u043b\u043e\u043d\u043a\u043e\u0439',' ','J','.'].join(''), p: ['\u041e\u0431\u0440\u0430\u0431\u043e\u0442\u043a\u0430','...'].join(''), a3t: ['\u041e\u0431\u0440\u0430\u0431\u043e\u0442\u043a\u0430',' ','\u0437\u0430\u0432\u0435\u0440\u0448\u0435\u043d\u0430','!'].join(''), e1: ['\u041e\u0428\u0418\u0411\u041a\u0410',':',' ','\u0426\u0438\u043a\u043b',' ','\u0440\u0435\u0434\u0438\u0440\u0435\u043a\u0442\u0430',' ','\u043d\u0430',' '].join(''), e2: ['\u041e\u0428\u0418\u0411\u041a\u0410',':',' ','\u041f\u0440\u0435\u0432\u044b\u0448\u0435\u043d',' ','\u043b\u0438\u043c\u0438\u0442',' ','\u0440\u0435\u0434\u0438\u0440\u0435\u043a\u0442\u043e\u0432',' ','('].join(''), e3: ['\u041e\u0428\u0418\u0411\u041a\u0410',' ','\u0421\u0415\u0422\u0418',':',' '].join(''), dns: ['DNS',' ','error',':',' '].join(''), l: ['L','o','c','a','t','i','o','n'].join(''), lc: ['l','o','c','a','t','i','o','n'].join(''), ht: ['h','t','t','p'].join('')}, fo: {fR: !1, mhe: !0, vhc: !1}}};function onOpen() {SpreadsheetApp.getUi().createMenu(_cfg.s.t.mn).addItem(_cfg.s.t.i1, '_alpha').addSeparator().addItem(_cfg.s.t.i2, '_beta').addToUi();} function _alpha() {const _sh = SpreadsheetApp.getActiveSheet(); const _ar = _sh.getActiveRange().getRow(); const _ui = SpreadsheetApp.getUi(); const _res = _delta(_sh, _ar); _sh[_cfg.s.m[2]](_ar, _cfg.p.oc)[_cfg.s.m[7]](_res); _ui.alert(_cfg.s.t.a1t, _cfg.s.t.a1m + _ar + '\n\n' + _res, _ui.ButtonSet.OK);} function _beta() {const _sh = SpreadsheetApp.getActiveSheet(); const _ui = SpreadsheetApp.getUi(); const _oc = _cfg.p.oc; const _sr = _cfg.p.sr; const _lr = _sh.getLastRow(); const _resp = _ui.alert(_cfg.s.t.a2t, `${_cfg.s.t.a2m1}${_sr}${_cfg.s.t.a2m2}${_lr}${_cfg.s.t.a2m3}`, _ui.ButtonSet.OK_CANCEL); if (_resp !== _ui.Button.OK) {return;} for (let i = _sr; i <= _lr; i++) {const _ocell = _sh[_cfg.s.m[2]](i, _oc); if (!_ocell[_cfg.s.m[6]]()) {continue;} const _scell = _sh[_cfg.s.m[2]](i, 1); if (_scell[_cfg.s.m[6]]() || !_scell[_cfg.s.m[3]]()[_cfg.s.m[4]]()) {continue;} _ocell[_cfg.s.m[7]](_cfg.s.t.p); SpreadsheetApp.flush(); const _res = _delta(_sh, i); _ocell[_cfg.s.m[7]](_res); SpreadsheetApp.flush(); Utilities.sleep(_cfg.p.slp);} _ui.alert(_cfg.s.t.a3t);} function _delta(_sh, _r) {const _iu = _sh[_cfg.s.m[2]](_r, 1)[_cfg.s.m[3]]()[_cfg.s.m[4]](); if (!_iu) {return '';} let _cu = _iu; const _vu = {}; const _mr = _cfg.p.mr; for (let i = 0; i < _mr; i++) {if (_vu[_cu]) {return `${_cfg.s.t.e1}${_cu}`;} _vu[_cu] = !0; try {const _resp = UrlFetchApp.fetch(_cu, {method: _cfg.s.m[0], followRedirects: _cfg.fo.fR, muteHttpExceptions: _cfg.fo.mhe, validateHttpsCertificates: _cfg.fo.vhc}); const _loc = _resp[_cfg.s.m[5]]()[_cfg.s.t.l] || _resp[_cfg.s.m[5]]()[_cfg.s.t.lc]; if (_loc && _loc !== _cu) {if (_loc[_cfg.s.m[10]]()[_cfg.s.m[11]](_cfg.s.t.ht) === 0) {_cu = _loc;} else if (_loc.charAt(0) === '/') {const parts = _cu[_cfg.s.m[12]]('/'); _cu = parts[0] + '//' + parts[2] + _loc;} else {const lastSlash = _cu[_cfg.s.m[13]]('/'); _cu = _cu[_cfg.s.m[14]](0, lastSlash + 1) + _loc;}} else {return _cu;}} catch (e) {if (e.message[_cfg.s.m[11]](_cfg.s.t.dns) !== -1) {return e.message[_cfg.s.m[8]](_cfg.s.t.dns, '')[_cfg.s.m[9]]();} return `${_cfg.s.t.e3}${e.message}`;}} return `${_cfg.s.t.e2}${_mr})`;}
